{% extends 'base.html' %}
{% load static %}
{% block title %}Teams | Turnamenku{% endblock title %}

{% block extra_css %}
{# Jika kamu punya stylesteams.css, biarkan. Jika tidak, hapus baris ini. #}
<link rel="stylesheet" href="{% static 'css/stylesteams.css' %}">
{% endblock %}

{% block content %}
{% include 'layout_navbar.html' %}

<div class="container mx-auto px-4 py-8 md:py-16">

  <div class="grid grid-cols-1 md:grid-cols-3 gap-6 md:gap-8">

    <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 text-center flex flex-col">
      <div class="flex justify-center items-center h-24">
        <img src="https://img.icons8.com/?size=100&id=D47p6uA2kE9C&format=png&color=000000" alt="team leadership"
          class="h-20 w-20" />
      </div>
      <h2 class="text-xl font-bold text-gray-800 mt-4 mb-2">Tim Kamu</h2>
      <p class="text-gray-600 text-sm mb-4 flex-grow">
        Saatnya melihat siapa partner kamu! Cek detail tim kamu dan mulai rencanakan langkah selanjutnya!. GASKEUNN!!!
      </p>
      <button onclick="openModal('modal-meet')"
        class="w-full bg-custom-blue-400 text-white font-semibold py-2 px-4 rounded-lg hover:bg-custom-blue-300 transition duration-150 ease-in-out">
        Mana teamku?
      </button>
    </div>

    <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 text-center flex flex-col">
      <div class="flex justify-center items-center h-24">
        <img src="https://img.icons8.com/?size=100&id=v3iFMJQ6YCbu&format=png&color=000000" alt="joining team"
          class="h-20 w-20" />
      </div>
      <h2 class="text-xl font-bold text-gray-800 mt-4 mb-2">Gabung Tim</h2>
      <p class="text-gray-600 text-sm mb-4 flex-grow">
        Kamu butuh team? mungkin dari sini perjalanan kamu dimulai. Ga mungkin ditolak jadi member karena pasti
        diterima.
      </p>
      <button onclick="openModal('modal-join')"
        class="w-full bg-custom-blue-400 text-white font-semibold py-2 px-4 rounded-lg hover:bg-custom-blue-300 transition duration-150 ease-in-out">
        Aku butuh tim
      </button>
    </div>

    <div class="bg-white p-6 rounded-xl shadow-lg border border-gray-200 text-center flex flex-col">
      <div class="flex justify-center items-center h-24">
        <img src="https://img.icons8.com/?size=100&id=44823&format=png&color=000000" alt="manage team"
          class="h-20 w-20" />
      </div>
      <h2 class="text-xl font-bold text-gray-800 mt-4 mb-2">Kelola Tim</h2>
      <p class="text-gray-600 text-sm mb-4 flex-grow">
        Sebagai kapten mengeluarkan anggota team dan mengganti komponen team lainnya adalah hal yang mudah.
      </p>
      <button onclick="openModal('modal-manage')"
        class="w-full bg-custom-blue-400 text-white font-semibold py-2 px-4 rounded-lg hover:bg-custom-blue-300 transition duration-150 ease-in-out">
        Saatnya bekerja
      </button>
    </div>
  </div>

  <div class="flex flex-col items-center justify-center mt-12 mb-16">
    <button onclick="openModal('modal-create-team')"
      class="bg-green-500 text-white font-bold py-3 px-8 text-lg rounded-lg hover:bg-green-600 transition shadow-lg">
      Buat Tim Baru
    </button>
    <p class="text-gray-600 text-sm mt-3">
      Jadilah kapten dari teammu sendiri!
    </p>
  </div>
</div>

{% include 'create_team.html' %} Â 
{% include 'meet_teams.html' %}
{% include 'manage_team.html' %}
{% include 'join_teams.html' %}

{% endblock content %}

{% block javascript %}
<script>
  // Fungsi global untuk membuka modal
  function openModal(modalId, teamId = null) {
    const modal = document.getElementById(modalId);
    if (!modal) {
      console.error(`Modal dengan ID '${modalId}' tidak ditemukan`);
      return;
    }

    // Tampilkan modal menggunakan kelas Tailwind
    modal.classList.remove('hidden');
    modal.classList.add('flex'); // Gunakan flex untuk centering

    // Jalankan fungsi search/load data yang sesuai
    if (modalId === 'modal-manage') {
      if (typeof searchManageTeams === 'function') searchManageTeams(1);
    } else if (modalId === 'modal-join') {
      if (typeof searchJoinTeams === 'function') searchJoinTeams(1);
    } else if (modalId === 'modal-meet') {
      if (typeof searchMeetTeams === 'function') searchMeetTeams(1);
    } else if (modalId === 'modal-configure') {
      if (teamId && typeof openConfigureModal === 'function') {
        // Buka juga modal configure (karena openModal dipanggil dari manage)
        const configModal = document.getElementById('modal-configure');
        if (configModal) {
          configModal.classList.remove('hidden');
          configModal.classList.add('flex');
        }
        openConfigureModal(teamId); // Fungsi ini dari manage_team.html
      }
    }
  }

  // Fungsi global untuk menutup modal
  function closeModal(modalId) {
    const modal = document.getElementById(modalId);
    if (modal) {
      // Sembunyikan modal menggunakan kelas Tailwind
      modal.classList.add('hidden');
      modal.classList.remove('flex');
    }
  }

  // Fungsi global untuk ambil CSRF token
  function getCSRFToken() {
    // Coba ambil dari form dulu (jika ada)
    const formToken = document.querySelector('form input[name="csrfmiddlewaretoken"]');
    if (formToken) {
      return formToken.value;
    }
    // Fallback ambil dari cookie
    const cookieValue = document.cookie.split('; ').find(row => row.startsWith('csrftoken='))?.split('=')[1];
    return cookieValue || "";
  }

  // URL Logo Default
  const DEFAULT_TEAM_LOGO = "https://img.icons8.com/?size=100&id=uMMzE4KzgxCO&format=png&color=000000";

</script>

{% endblock javascript %}